2020/11/20(五), 109學年第一學期 資料科學應用 R小考(1)
補考時間2020/11/21 14:21-15:21

學號:A106260093        姓名:王緯華 

# (請依照規定)貼上執行程式碼及執行結果。
詳見: R程式作業繳交方式
http://www.hmwu.idv.tw/web/teaching/doc/R-how-homework.pdf

> #小考1120
> #1(a)讀入兩資料檔，並印出兩資料的前、後各5 筆紀錄
> install.packages("readxl")
Error in install.packages : Updating loaded packages
> library(readxl)
> install.packages("readr")
Error in install.packages : Updating loaded packages
> library(readr)
> Calculus_score_A <- read.csv("data/Calculus-score-A.csv", header = TRUE, sep=",", na = "NA", skip=2)
> Calculus_score_A
   座號      學號   姓名 性別 X7. X7..1 X8. X8..1
1     1 401405008 希瑄彥   男  10     0   5    20
2     2 401550880 張泓丞   男  25    40  70    87
3     3 404550061 張安婕   女  18    15  48    33
4     4 404550042 柯政學   男  10    10  NA    NA
5     5 404550023 謝文躍   女  35    45  52    97
6     6 404550000 張樺玫   男  30    35  90    67
7     7 404550057 徐  敬   女  12    10  38     3
8     8 404550075 王亞詠   女  30    45  85    65
9     9 404550013 王承庭   男  30    15  72    37
10   10 404550001 高羽黛   女  25    10  50    NA
11   11 404550189 丁易偉   女  80   100 100    93
12   12 404550177 彥氏丞   男  40    20  55    38
13   13 404550155 婕　學   女   0    10  40    NA
14   14 404550143 躍庭祐   女   9     0  50    30
15   15 404550161 玫鈞霖   男  25    30  85    53
16   16 404550149 家聿穎   女  47    60  70    82
17   17 404550126 詠吾筑   男   3     5  NA    NA
18   18 404550294 庭馨儀   女   5     0  30    NA
19   19 404550272 黛婕西   女  20    13  60    43
20   20 404550250 偉茹麥   男   2    20  50    65
21   21 404550238 氏存水   女   0    23  30     7
22   22 404550216 家芳榮   女  50    28  80    97
23   23 404550294 嫣玲杰   女   0     0  NA    NA
24   24 404550272 美慈蒙   女  13    48  73    65
25   25 404550250 鈺玲豪   男  55    25  65    60
26   26 404550215 宜  慈   男  40    58  65    30
27   27 404550287 柯陳渝   男   0    45  53    40
28   28 404550361 紀鍾暄   男  50    50  90    68
29   29 404550340 蔡鍾毅   男  35    15  82    28
30   30 404550328 梅林茹   男  25    65  62    41
31   31 404550386 王柯辰   女  45    53  77    57
32   32 404550360 曾紀崴   女  45    55  83    64
33   33 404550344 呂蔡嘉   男  30    40  90    78
34   34 404550322 廖繆傑   男  30    35 100    82
35   35 404550328 李梅祐   男  20    25  55    32
36   36 404550369 陳王霖   女  55    73  92    73
37   37 404550420 何瑄穎   男  28    10  35     3
38   38 404550431 沈泓霏   女  15    25  53    67
39   39 404550442 許安霏   女  53    60  80    72
40   40 404550453 李政宜   男  80   100  85   100
    X15. X25. X30. Times
1    0.0   55   50     2
2   80.0   46   68     9
3   86.7   54   79     9
4   13.3    2    0     7
5   86.7   55   67     9
6   86.7   54   48     9
7   80.0   32   17     9
8   93.3   60   77     9
9   86.7   27   33     7
10  46.7   24    0     1
11  93.3   90   93     4
12  86.7   71   53     9
13  60.0    5    0     2
14  60.0    0    0     6
15 100.0   54   72     9
16 100.0   61   75     7
17  40.0    8    0     0
18  93.3   18    0     3
19  86.7   43   62     9
20  80.0   42   77     5
21  93.3   45   37     9
22 100.0   35   54     9
23  53.3    0    0     3
24  93.3   45   65     7
25 100.0    8   88     9
26 100.0   21   85     9
27  93.3   37   76     9
28 100.0   50   93     9
29 100.0   34   71     9
30 100.0   82   65     9
31 100.0   51   70     9
32 100.0   52   47     9
33 100.0   22   88     7
34 100.0   51   88     9
35  86.7   41   48     7
36 100.0   72   81     9
37  66.7   30    0     7
38  93.3   29   42     9
39 100.0   61   62     9
40 100.0   95  100     3
> Calculus_score_B <- read_excel("data/Calculus-score-B.xls", sheet = "工作表1",  na = "NA", skip=2)
New names:
* `0.070000000000000007` -> `0.070000000000000007...5`
* `0.070000000000000007` -> `0.070000000000000007...6`
* `0.080000000000000002` -> `0.080000000000000002...7`
* `0.080000000000000002` -> `0.080000000000000002...8`
> Calculus_score_B
# A tibble: 55 x 12
    座號   學號 姓名  性別  `0.070000000000~
   <dbl>  <dbl> <chr> <chr>            <dbl>
 1     1 4.05e8 史文羽~ 男                  60
 2     2 4.05e8 鄭樺妤~ 男                  80
 3     3 4.05e8 張敬安~ 男                  10
 4     4 4.05e8 何筑亦~ 女                  15
 5     5 4.05e8 張  儀~ 女                  30
 6     6 4.02e8 雷西萱~ 男                  75
 7     7 4.02e8 張麥笙~ 女                  60
 8     8 4.04e8 張水兆~ 男                   0
 9     9 4.05e8 柯榮品~ 男                   0
10    10 4.05e8 謝卡欣~ 男                  30
# ... with 45 more rows, and 7 more variables:
#   `0.070000000000000007...6` <dbl>,
#   `0.080000000000000002...7` <dbl>,
#   `0.080000000000000002...8` <dbl>,
#   `0.14999999999999999` <dbl>, `0.25` <dbl>,
#   `0.29999999999999999` <dbl>, Times <dbl>
> 
> head(Calculus_score_A, 5)
  座號      學號   姓名 性別 X7. X7..1 X8. X8..1 X15.
1    1 401405008 希瑄彥   男  10     0   5    20  0.0
2    2 401550880 張泓丞   男  25    40  70    87 80.0
3    3 404550061 張安婕   女  18    15  48    33 86.7
4    4 404550042 柯政學   男  10    10  NA    NA 13.3
5    5 404550023 謝文躍   女  35    45  52    97 86.7
  X25. X30. Times
1   55   50     2
2   46   68     9
3   54   79     9
4    2    0     7
5   55   67     9
> head(Calculus_score_B, 5)
# A tibble: 5 x 12
   座號   學號 姓名  性別  `0.070000000000~
  <dbl>  <dbl> <chr> <chr>            <dbl>
1     1 4.05e8 史文羽~ 男                  60
2     2 4.05e8 鄭樺妤~ 男                  80
3     3 4.05e8 張敬安~ 男                  10
4     4 4.05e8 何筑亦~ 女                  15
5     5 4.05e8 張  儀~ 女                  30
# ... with 7 more variables:
#   `0.070000000000000007...6` <dbl>,
#   `0.080000000000000002...7` <dbl>,
#   `0.080000000000000002...8` <dbl>,
#   `0.14999999999999999` <dbl>, `0.25` <dbl>,
#   `0.29999999999999999` <dbl>, Times <dbl>
> 
> #1(b)
> colnames(Calculus_score_A) <- c("NO", "ID", "Name", "Gender", "Quiz1",  "Quiz2", "Quiz3", "Quiz4", "TA", "Midterm", "Final", "ATT")
> colnames(Calculus_score_B) <- c("NO", "ID", "Name", "Gender", "Quiz1",  "Quiz2", "Quiz3", "Quiz4", "TA", "Midterm", "Final", "ATT")
> Calculus_score_A
   NO        ID   Name Gender Quiz1 Quiz2 Quiz3 Quiz4
1   1 401405008 希瑄彥     男    10     0     5    20
2   2 401550880 張泓丞     男    25    40    70    87
3   3 404550061 張安婕     女    18    15    48    33
4   4 404550042 柯政學     男    10    10    NA    NA
5   5 404550023 謝文躍     女    35    45    52    97
6   6 404550000 張樺玫     男    30    35    90    67
7   7 404550057 徐  敬     女    12    10    38     3
8   8 404550075 王亞詠     女    30    45    85    65
9   9 404550013 王承庭     男    30    15    72    37
10 10 404550001 高羽黛     女    25    10    50    NA
11 11 404550189 丁易偉     女    80   100   100    93
12 12 404550177 彥氏丞     男    40    20    55    38
13 13 404550155 婕　學     女     0    10    40    NA
14 14 404550143 躍庭祐     女     9     0    50    30
15 15 404550161 玫鈞霖     男    25    30    85    53
16 16 404550149 家聿穎     女    47    60    70    82
17 17 404550126 詠吾筑     男     3     5    NA    NA
18 18 404550294 庭馨儀     女     5     0    30    NA
19 19 404550272 黛婕西     女    20    13    60    43
20 20 404550250 偉茹麥     男     2    20    50    65
21 21 404550238 氏存水     女     0    23    30     7
22 22 404550216 家芳榮     女    50    28    80    97
23 23 404550294 嫣玲杰     女     0     0    NA    NA
24 24 404550272 美慈蒙     女    13    48    73    65
25 25 404550250 鈺玲豪     男    55    25    65    60
26 26 404550215 宜  慈     男    40    58    65    30
27 27 404550287 柯陳渝     男     0    45    53    40
28 28 404550361 紀鍾暄     男    50    50    90    68
29 29 404550340 蔡鍾毅     男    35    15    82    28
30 30 404550328 梅林茹     男    25    65    62    41
31 31 404550386 王柯辰     女    45    53    77    57
32 32 404550360 曾紀崴     女    45    55    83    64
33 33 404550344 呂蔡嘉     男    30    40    90    78
34 34 404550322 廖繆傑     男    30    35   100    82
35 35 404550328 李梅祐     男    20    25    55    32
36 36 404550369 陳王霖     女    55    73    92    73
37 37 404550420 何瑄穎     男    28    10    35     3
38 38 404550431 沈泓霏     女    15    25    53    67
39 39 404550442 許安霏     女    53    60    80    72
40 40 404550453 李政宜     男    80   100    85   100
      TA Midterm Final ATT
1    0.0      55    50   2
2   80.0      46    68   9
3   86.7      54    79   9
4   13.3       2     0   7
5   86.7      55    67   9
6   86.7      54    48   9
7   80.0      32    17   9
8   93.3      60    77   9
9   86.7      27    33   7
10  46.7      24     0   1
11  93.3      90    93   4
12  86.7      71    53   9
13  60.0       5     0   2
14  60.0       0     0   6
15 100.0      54    72   9
16 100.0      61    75   7
17  40.0       8     0   0
18  93.3      18     0   3
19  86.7      43    62   9
20  80.0      42    77   5
21  93.3      45    37   9
22 100.0      35    54   9
23  53.3       0     0   3
24  93.3      45    65   7
25 100.0       8    88   9
26 100.0      21    85   9
27  93.3      37    76   9
28 100.0      50    93   9
29 100.0      34    71   9
30 100.0      82    65   9
31 100.0      51    70   9
32 100.0      52    47   9
33 100.0      22    88   7
34 100.0      51    88   9
35  86.7      41    48   7
36 100.0      72    81   9
37  66.7      30     0   7
38  93.3      29    42   9
39 100.0      61    62   9
40 100.0      95   100   3
> Calculus_score_B
# A tibble: 55 x 12
      NO        ID Name  Gender Quiz1 Quiz2 Quiz3 Quiz4
   <dbl>     <dbl> <chr> <chr>  <dbl> <dbl> <dbl> <dbl>
 1     1 404550465 史文羽~ 男        60    81   100    97
 2     2 404685071 鄭樺妤~ 男        80   100   100    92
 3     3 404685084 張敬安~ 男        10    40    62    93
 4     4 404685099 何筑亦~ 女        15    25    40    13
 5     5 404685100 張  儀~ 女        30    45    70    61
 6     6 401550816 雷西萱~ 男        75    78    67    58
 7     7 401555528 張麥笙~ 女        60    33    15    65
 8     8 403555042 張水兆~ 男         0    30    50    80
 9     9 404720052 柯榮品~ 男         0     0     5    NA
10    10 404720063 謝卡欣~ 男        30    25    30    10
# ... with 45 more rows, and 4 more variables:
#   TA <dbl>, Midterm <dbl>, Final <dbl>, ATT <dbl>
> score_AB <- rbind(Calculus_score_A, Calculus_score_B)
> score_AB
   NO        ID   Name Gender Quiz1 Quiz2 Quiz3 Quiz4
1   1 401405008 希瑄彥     男    10     0     5    20
2   2 401550880 張泓丞     男    25    40    70    87
3   3 404550061 張安婕     女    18    15    48    33
4   4 404550042 柯政學     男    10    10    NA    NA
5   5 404550023 謝文躍     女    35    45    52    97
6   6 404550000 張樺玫     男    30    35    90    67
7   7 404550057 徐  敬     女    12    10    38     3
8   8 404550075 王亞詠     女    30    45    85    65
9   9 404550013 王承庭     男    30    15    72    37
10 10 404550001 高羽黛     女    25    10    50    NA
11 11 404550189 丁易偉     女    80   100   100    93
12 12 404550177 彥氏丞     男    40    20    55    38
13 13 404550155 婕　學     女     0    10    40    NA
14 14 404550143 躍庭祐     女     9     0    50    30
15 15 404550161 玫鈞霖     男    25    30    85    53
16 16 404550149 家聿穎     女    47    60    70    82
17 17 404550126 詠吾筑     男     3     5    NA    NA
18 18 404550294 庭馨儀     女     5     0    30    NA
19 19 404550272 黛婕西     女    20    13    60    43
20 20 404550250 偉茹麥     男     2    20    50    65
21 21 404550238 氏存水     女     0    23    30     7
22 22 404550216 家芳榮     女    50    28    80    97
23 23 404550294 嫣玲杰     女     0     0    NA    NA
24 24 404550272 美慈蒙     女    13    48    73    65
25 25 404550250 鈺玲豪     男    55    25    65    60
26 26 404550215 宜  慈     男    40    58    65    30
27 27 404550287 柯陳渝     男     0    45    53    40
28 28 404550361 紀鍾暄     男    50    50    90    68
29 29 404550340 蔡鍾毅     男    35    15    82    28
30 30 404550328 梅林茹     男    25    65    62    41
31 31 404550386 王柯辰     女    45    53    77    57
32 32 404550360 曾紀崴     女    45    55    83    64
33 33 404550344 呂蔡嘉     男    30    40    90    78
34 34 404550322 廖繆傑     男    30    35   100    82
35 35 404550328 李梅祐     男    20    25    55    32
36 36 404550369 陳王霖     女    55    73    92    73
37 37 404550420 何瑄穎     男    28    10    35     3
38 38 404550431 沈泓霏     女    15    25    53    67
39 39 404550442 許安霏     女    53    60    80    72
40 40 404550453 李政宜     男    80   100    85   100
41  1 404550465 史文羽     男    60    81   100    97
42  2 404685071 鄭樺妤     男    80   100   100    92
43  3 404685084 張敬安     男    10    40    62    93
44  4 404685099 何筑亦     女    15    25    40    13
45  5 404685100 張  儀     女    30    45    70    61
46  6 401550816 雷西萱     男    75    78    67    58
47  7 401555528 張麥笙     女    60    33    15    65
48  8 403555042 張水兆     男     0    30    50    80
49  9 404720052 柯榮品     男     0     0     5    NA
50 10 404720063 謝卡欣     男    30    25    30    10
51 11 404720074 張莉儷     男    25    10    10    15
52 12 404720005 王恭莞     女    53    25    80    85
53 13 404720016 王琇易     男    15     5    15    90
54 14 404720027 高凱瓊     男    15    40    35    60
55 15 404720038 丁乃愛     男    55    70    85    80
56 16 404720049 張瑞書     女    20    28    10    70
57 17 404720150 曾銘清     男    65    63    15    50
58 18 404720161 劉莞韋     男    95    86    85    75
59 19 404720172 曾易佳     男    80    65    98    75
60 20 404720184 黃瓊品     男    15     0     5     0
61 21 404720195 廖愛靜     男    30    30    20    20
62 22 404720106 詹書飛     男    65    80    80    85
63 23 404720117 劉徐卉     男    65    90    70    65
64 24 404720211 許怡怡     男    30    10    20    20
65 25 404720427 鄭  芊     男    30     5    10    65
66 26 404720526 楊亞易     女    25    NA    NA    NA
67 27 404720624 張羽廖     男    45     0    30    65
68 28 404720722 楊佳聿     女    30    35    20    50
69 29 404720429 吾靜宜     男    55    20     5    15
70 30 404720527 馨飛羽     男    15     0    45    65
71 31 404720625 婕曾卉     男    10     0     0    66
72 32 404720723 茹呂怡     男    35    50    30    90
73 33 404720821 存廖芊     男    20    15    10    55
74 34 404720929 芳李米     男    35    15    40    65
75 35 404720037 勳  陳     男    20    30    22    60
76 36 404720135 萱何兆     男    35    25    85    55
77 37 404720231 笙沈品     男    40    58    45    70
78 38 404720338 倩許欣     男    50    60    60    30
79 39 404720436 曼李儷     女    60    40    73    90
80 40 404720534 雅清史     女     0    15    NA    NA
81 41 404720638 恭倩鄭     男    20    15    50    70
82 42 404720736 琇曼張     女    58    40    80    55
83 43 404720834 張雅益     女    60    75    85    85
      TA Midterm Final ATT
1    0.0      55    50   2
2   80.0      46    68   9
3   86.7      54    79   9
4   13.3       2     0   7
5   86.7      55    67   9
6   86.7      54    48   9
7   80.0      32    17   9
8   93.3      60    77   9
9   86.7      27    33   7
10  46.7      24     0   1
11  93.3      90    93   4
12  86.7      71    53   9
13  60.0       5     0   2
14  60.0       0     0   6
15 100.0      54    72   9
16 100.0      61    75   7
17  40.0       8     0   0
18  93.3      18     0   3
19  86.7      43    62   9
20  80.0      42    77   5
21  93.3      45    37   9
22 100.0      35    54   9
23  53.3       0     0   3
24  93.3      45    65   7
25 100.0       8    88   9
26 100.0      21    85   9
27  93.3      37    76   9
28 100.0      50    93   9
29 100.0      34    71   9
30 100.0      82    65   9
31 100.0      51    70   9
32 100.0      52    47   9
33 100.0      22    88   7
34 100.0      51    88   9
35  86.7      41    48   7
36 100.0      72    81   9
37  66.7      30     0   7
38  93.3      29    42   9
39 100.0      61    62   9
40 100.0      95   100   3
41 100.0      90    83   6
42 100.0      92    97   2
43 100.0      65    84   9
44  93.3      36     5   9
45  93.3      29    48   4
46  93.3      35    33   9
47  87.0      65    47   5
48  13.0      NA    90   9
49  73.0       5    NA   9
50  60.0      21    38   4
51  73.0      13    15   9
52  80.0      73    63   9
53  87.0       3    52   9
54  80.0      42    32   9
55 100.0      49    45   7
56  80.0      36    22   6
57  80.0      57    55   4
58 100.0      80    82   9
59  80.0      64    80   2
60  73.0       7    16   5
61  80.0      14    24   9
62 100.0      63    65   7
63 100.0      68    64   0
64  67.0      12    NA   3
65 100.0      35    20   9
66  67.0       0     0   9
67  73.0      55    57   9
68  60.0      45    63   9
69  73.0      44    30   3
70  93.0      44    44   7
71  67.0       5     0   9
72 100.0      56    55   9
73  80.0      28    46   9
74 100.0      48    50   9
75  80.0      50    38   9
76 100.0      58    70   9
77 100.0      70    46   9
78 100.0      34    68   9
79 100.0      68    87   7
80  60.0       9    NA   9
81 100.0      71    68   7
82 100.0      57    75   9
83 100.0      71    65   7
 [ reached 'max' / getOption("max.print") -- omitted 12 rows ]
> 
> Class <- c(rep(LETTERS[1], 40), rep(LETTERS[2], 55))
> Class
 [1] "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A"
[13] "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A"
[25] "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A"
[37] "A" "A" "A" "A" "B" "B" "B" "B" "B" "B" "B" "B"
[49] "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B"
[61] "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B"
[73] "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B"
[85] "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B"
> score <- data.frame(score_AB, Class)
> score
   NO        ID   Name Gender Quiz1 Quiz2 Quiz3 Quiz4
1   1 401405008 希瑄彥     男    10     0     5    20
2   2 401550880 張泓丞     男    25    40    70    87
3   3 404550061 張安婕     女    18    15    48    33
4   4 404550042 柯政學     男    10    10    NA    NA
5   5 404550023 謝文躍     女    35    45    52    97
6   6 404550000 張樺玫     男    30    35    90    67
7   7 404550057 徐  敬     女    12    10    38     3
8   8 404550075 王亞詠     女    30    45    85    65
9   9 404550013 王承庭     男    30    15    72    37
10 10 404550001 高羽黛     女    25    10    50    NA
11 11 404550189 丁易偉     女    80   100   100    93
12 12 404550177 彥氏丞     男    40    20    55    38
13 13 404550155 婕　學     女     0    10    40    NA
14 14 404550143 躍庭祐     女     9     0    50    30
15 15 404550161 玫鈞霖     男    25    30    85    53
16 16 404550149 家聿穎     女    47    60    70    82
17 17 404550126 詠吾筑     男     3     5    NA    NA
18 18 404550294 庭馨儀     女     5     0    30    NA
19 19 404550272 黛婕西     女    20    13    60    43
20 20 404550250 偉茹麥     男     2    20    50    65
21 21 404550238 氏存水     女     0    23    30     7
22 22 404550216 家芳榮     女    50    28    80    97
23 23 404550294 嫣玲杰     女     0     0    NA    NA
24 24 404550272 美慈蒙     女    13    48    73    65
25 25 404550250 鈺玲豪     男    55    25    65    60
26 26 404550215 宜  慈     男    40    58    65    30
27 27 404550287 柯陳渝     男     0    45    53    40
28 28 404550361 紀鍾暄     男    50    50    90    68
29 29 404550340 蔡鍾毅     男    35    15    82    28
30 30 404550328 梅林茹     男    25    65    62    41
31 31 404550386 王柯辰     女    45    53    77    57
32 32 404550360 曾紀崴     女    45    55    83    64
33 33 404550344 呂蔡嘉     男    30    40    90    78
34 34 404550322 廖繆傑     男    30    35   100    82
35 35 404550328 李梅祐     男    20    25    55    32
36 36 404550369 陳王霖     女    55    73    92    73
37 37 404550420 何瑄穎     男    28    10    35     3
38 38 404550431 沈泓霏     女    15    25    53    67
39 39 404550442 許安霏     女    53    60    80    72
40 40 404550453 李政宜     男    80   100    85   100
41  1 404550465 史文羽     男    60    81   100    97
42  2 404685071 鄭樺妤     男    80   100   100    92
43  3 404685084 張敬安     男    10    40    62    93
44  4 404685099 何筑亦     女    15    25    40    13
45  5 404685100 張  儀     女    30    45    70    61
46  6 401550816 雷西萱     男    75    78    67    58
47  7 401555528 張麥笙     女    60    33    15    65
48  8 403555042 張水兆     男     0    30    50    80
49  9 404720052 柯榮品     男     0     0     5    NA
50 10 404720063 謝卡欣     男    30    25    30    10
51 11 404720074 張莉儷     男    25    10    10    15
52 12 404720005 王恭莞     女    53    25    80    85
53 13 404720016 王琇易     男    15     5    15    90
54 14 404720027 高凱瓊     男    15    40    35    60
55 15 404720038 丁乃愛     男    55    70    85    80
56 16 404720049 張瑞書     女    20    28    10    70
57 17 404720150 曾銘清     男    65    63    15    50
58 18 404720161 劉莞韋     男    95    86    85    75
59 19 404720172 曾易佳     男    80    65    98    75
60 20 404720184 黃瓊品     男    15     0     5     0
61 21 404720195 廖愛靜     男    30    30    20    20
62 22 404720106 詹書飛     男    65    80    80    85
63 23 404720117 劉徐卉     男    65    90    70    65
64 24 404720211 許怡怡     男    30    10    20    20
65 25 404720427 鄭  芊     男    30     5    10    65
66 26 404720526 楊亞易     女    25    NA    NA    NA
67 27 404720624 張羽廖     男    45     0    30    65
68 28 404720722 楊佳聿     女    30    35    20    50
69 29 404720429 吾靜宜     男    55    20     5    15
70 30 404720527 馨飛羽     男    15     0    45    65
71 31 404720625 婕曾卉     男    10     0     0    66
72 32 404720723 茹呂怡     男    35    50    30    90
73 33 404720821 存廖芊     男    20    15    10    55
74 34 404720929 芳李米     男    35    15    40    65
75 35 404720037 勳  陳     男    20    30    22    60
76 36 404720135 萱何兆     男    35    25    85    55
      TA Midterm Final ATT Class
1    0.0      55    50   2     A
2   80.0      46    68   9     A
3   86.7      54    79   9     A
4   13.3       2     0   7     A
5   86.7      55    67   9     A
6   86.7      54    48   9     A
7   80.0      32    17   9     A
8   93.3      60    77   9     A
9   86.7      27    33   7     A
10  46.7      24     0   1     A
11  93.3      90    93   4     A
12  86.7      71    53   9     A
13  60.0       5     0   2     A
14  60.0       0     0   6     A
15 100.0      54    72   9     A
16 100.0      61    75   7     A
17  40.0       8     0   0     A
18  93.3      18     0   3     A
19  86.7      43    62   9     A
20  80.0      42    77   5     A
21  93.3      45    37   9     A
22 100.0      35    54   9     A
23  53.3       0     0   3     A
24  93.3      45    65   7     A
25 100.0       8    88   9     A
26 100.0      21    85   9     A
27  93.3      37    76   9     A
28 100.0      50    93   9     A
29 100.0      34    71   9     A
30 100.0      82    65   9     A
31 100.0      51    70   9     A
32 100.0      52    47   9     A
33 100.0      22    88   7     A
34 100.0      51    88   9     A
35  86.7      41    48   7     A
36 100.0      72    81   9     A
37  66.7      30     0   7     A
38  93.3      29    42   9     A
39 100.0      61    62   9     A
40 100.0      95   100   3     A
41 100.0      90    83   6     B
42 100.0      92    97   2     B
43 100.0      65    84   9     B
44  93.3      36     5   9     B
45  93.3      29    48   4     B
46  93.3      35    33   9     B
47  87.0      65    47   5     B
48  13.0      NA    90   9     B
49  73.0       5    NA   9     B
50  60.0      21    38   4     B
51  73.0      13    15   9     B
52  80.0      73    63   9     B
53  87.0       3    52   9     B
54  80.0      42    32   9     B
55 100.0      49    45   7     B
56  80.0      36    22   6     B
57  80.0      57    55   4     B
58 100.0      80    82   9     B
59  80.0      64    80   2     B
60  73.0       7    16   5     B
61  80.0      14    24   9     B
62 100.0      63    65   7     B
63 100.0      68    64   0     B
64  67.0      12    NA   3     B
65 100.0      35    20   9     B
66  67.0       0     0   9     B
67  73.0      55    57   9     B
68  60.0      45    63   9     B
69  73.0      44    30   3     B
70  93.0      44    44   7     B
71  67.0       5     0   9     B
72 100.0      56    55   9     B
73  80.0      28    46   9     B
74 100.0      48    50   9     B
75  80.0      50    38   9     B
76 100.0      58    70   9     B
 [ reached 'max' / getOption("max.print") -- omitted 19 rows ]
> score[38:43,]
   NO        ID   Name Gender Quiz1 Quiz2 Quiz3 Quiz4
38 38 404550431 沈泓霏     女    15    25    53    67
39 39 404550442 許安霏     女    53    60    80    72
40 40 404550453 李政宜     男    80   100    85   100
41  1 404550465 史文羽     男    60    81   100    97
42  2 404685071 鄭樺妤     男    80   100   100    92
43  3 404685084 張敬安     男    10    40    62    93
      TA Midterm Final ATT Class
38  93.3      29    42   9     A
39 100.0      61    62   9     A
40 100.0      95   100   3     A
41 100.0      90    83   6     B
42 100.0      92    97   2     B
43 100.0      65    84   9     B
> 
> #1(c)
> #將score中的NA填入0方便後續計算
> str(score)
'data.frame':	95 obs. of  13 variables:
 $ NO     : num  1 2 3 4 5 6 7 8 9 10 ...
 $ ID     : num  4.01e+08 4.02e+08 4.05e+08 4.05e+08 4.05e+08 ...
 $ Name   : chr  "希瑄彥" "張泓丞" "張安婕" "柯政學" ...
 $ Gender : chr  "男" "男" "女" "男" ...
 $ Quiz1  : num  10 25 18 10 35 30 12 30 30 25 ...
 $ Quiz2  : num  0 40 15 10 45 35 10 45 15 10 ...
 $ Quiz3  : num  5 70 48 NA 52 90 38 85 72 50 ...
 $ Quiz4  : num  20 87 33 NA 97 67 3 65 37 NA ...
 $ TA     : num  0 80 86.7 13.3 86.7 86.7 80 93.3 86.7 46.7 ...
 $ Midterm: num  55 46 54 2 55 54 32 60 27 24 ...
 $ Final  : num  50 68 79 0 67 48 17 77 33 0 ...
 $ ATT    : num  2 9 9 7 9 9 9 9 7 1 ...
 $ Class  : chr  "A" "A" "A" "A" ...
> score$Quiz1[is.na(score$Quiz1)] <- 0
> score$Quiz2[is.na(score$Quiz2)] <- 0
> score$Quiz3[is.na(score$Quiz3)] <- 0
> score$Quiz4[is.na(score$Quiz4)] <- 0
> score$TA[is.na(score$TA)] <- 0
> score$Midterm[is.na(score$Midterm)] <- 0
> score$Final[is.na(score$Final)] <- 0
> 
> score_matrix <- data.frame(score$Quiz1, score$Quiz2, score$Quiz3, score$Quiz4, score$TA, score$Midterm, score$Final)
> score_matrix
   score.Quiz1 score.Quiz2 score.Quiz3 score.Quiz4
1           10           0           5          20
2           25          40          70          87
3           18          15          48          33
4           10          10           0           0
5           35          45          52          97
6           30          35          90          67
7           12          10          38           3
8           30          45          85          65
9           30          15          72          37
10          25          10          50           0
11          80         100         100          93
12          40          20          55          38
13           0          10          40           0
14           9           0          50          30
15          25          30          85          53
16          47          60          70          82
17           3           5           0           0
18           5           0          30           0
19          20          13          60          43
20           2          20          50          65
21           0          23          30           7
22          50          28          80          97
23           0           0           0           0
24          13          48          73          65
25          55          25          65          60
26          40          58          65          30
27           0          45          53          40
28          50          50          90          68
29          35          15          82          28
30          25          65          62          41
31          45          53          77          57
32          45          55          83          64
33          30          40          90          78
34          30          35         100          82
35          20          25          55          32
36          55          73          92          73
37          28          10          35           3
38          15          25          53          67
39          53          60          80          72
40          80         100          85         100
41          60          81         100          97
42          80         100         100          92
43          10          40          62          93
44          15          25          40          13
45          30          45          70          61
46          75          78          67          58
47          60          33          15          65
48           0          30          50          80
49           0           0           5           0
50          30          25          30          10
51          25          10          10          15
52          53          25          80          85
53          15           5          15          90
54          15          40          35          60
55          55          70          85          80
56          20          28          10          70
57          65          63          15          50
58          95          86          85          75
59          80          65          98          75
60          15           0           5           0
61          30          30          20          20
62          65          80          80          85
63          65          90          70          65
64          30          10          20          20
65          30           5          10          65
66          25           0           0           0
67          45           0          30          65
68          30          35          20          50
69          55          20           5          15
70          15           0          45          65
71          10           0           0          66
72          35          50          30          90
73          20          15          10          55
74          35          15          40          65
75          20          30          22          60
76          35          25          85          55
77          40          58          45          70
78          50          60          60          30
79          60          40          73          90
80           0          15           0           0
81          20          15          50          70
82          58          40          80          55
83          60          75          85          85
84          55          18          30          50
85          40          43          85          80
86          45          40          10          50
87          70          15          60          50
88          96          55          85          70
89          98          80          98          98
90          88          73          85         100
91          80          85         100          85
92          48          35          48          98
93           0          38          60          40
94          50          70          20          85
95           5          35          45          55
   score.TA score.Midterm score.Final
1       0.0            55          50
2      80.0            46          68
3      86.7            54          79
4      13.3             2           0
5      86.7            55          67
6      86.7            54          48
7      80.0            32          17
8      93.3            60          77
9      86.7            27          33
10     46.7            24           0
11     93.3            90          93
12     86.7            71          53
13     60.0             5           0
14     60.0             0           0
15    100.0            54          72
16    100.0            61          75
17     40.0             8           0
18     93.3            18           0
19     86.7            43          62
20     80.0            42          77
21     93.3            45          37
22    100.0            35          54
23     53.3             0           0
24     93.3            45          65
25    100.0             8          88
26    100.0            21          85
27     93.3            37          76
28    100.0            50          93
29    100.0            34          71
30    100.0            82          65
31    100.0            51          70
32    100.0            52          47
33    100.0            22          88
34    100.0            51          88
35     86.7            41          48
36    100.0            72          81
37     66.7            30           0
38     93.3            29          42
39    100.0            61          62
40    100.0            95         100
41    100.0            90          83
42    100.0            92          97
43    100.0            65          84
44     93.3            36           5
45     93.3            29          48
46     93.3            35          33
47     87.0            65          47
48     13.0             0          90
49     73.0             5           0
50     60.0            21          38
51     73.0            13          15
52     80.0            73          63
53     87.0             3          52
54     80.0            42          32
55    100.0            49          45
56     80.0            36          22
57     80.0            57          55
58    100.0            80          82
59     80.0            64          80
60     73.0             7          16
61     80.0            14          24
62    100.0            63          65
63    100.0            68          64
64     67.0            12           0
65    100.0            35          20
66     67.0             0           0
67     73.0            55          57
68     60.0            45          63
69     73.0            44          30
70     93.0            44          44
71     67.0             5           0
72    100.0            56          55
73     80.0            28          46
74    100.0            48          50
75     80.0            50          38
76    100.0            58          70
77    100.0            70          46
78    100.0            34          68
79    100.0            68          87
80     60.0             9           0
81    100.0            71          68
82    100.0            57          75
83    100.0            71          65
84     80.0            58          15
85    100.0            63          53
86     93.0            28          35
87    100.0            39          66
88    100.0            75          95
89    100.0            96          95
90    100.0            83          83
91    100.0            89          95
92    100.0            50          62
93     87.0            49          25
94    100.0            54          69
95     87.0            58          60
> lapply(score_matrix,class)
$score.Quiz1
[1] "numeric"

$score.Quiz2
[1] "numeric"

$score.Quiz3
[1] "numeric"

$score.Quiz4
[1] "numeric"

$score.TA
[1] "numeric"

$score.Midterm
[1] "numeric"

$score.Final
[1] "numeric"

> 
> score_matrix$score.Quiz1 <- score_matrix$score.Quiz1 *0.07
> score_matrix$score.Quiz2 <- score_matrix$score.Quiz2 *0.07
> score_matrix$score.Quiz3 <- score_matrix$score.Quiz3 *0.08
> score_matrix$score.Quiz4 <- score_matrix$score.Quiz4 *0.08
> score_matrix$score.TA <- score_matrix$score.TA *0.15
> score_matrix$score.Midterm <- score_matrix$score.Midterm *0.25
> score_matrix$score.Final <- score_matrix$score.Final *0.30
> 
> 
> mean <- rowSums(score_matrix)
> all_mean <- mean+ score$ATT 
> Class_mean <- ifelse(all_mean>=100, 100, all_mean)
> Class_mean
 [1]  33.450  70.010  67.995  10.895  73.375  67.015
 [7]  38.920  78.345  48.525  20.455  96.435  67.295
[13]  16.150  22.030  73.990  79.400   8.560  24.245
[19]  61.905  61.340  49.915  68.570  10.995  67.055
[25]  68.000  69.210  65.635  84.040  66.100  78.540
[31]  75.330  69.860  72.240  82.260  54.765  88.460
[37]  30.205  55.245  77.920  99.150  94.030  97.060
[43]  81.350  40.535  55.375  62.355  61.310  50.450
[49]  21.600  36.700  32.150  76.810  48.200  52.550
[55]  69.700  43.360  60.910  94.070  77.990  23.950
[61]  39.100  80.600  72.850  22.050  47.200  20.800
[67]  61.550  58.300  40.800  55.000  26.280  70.050
[73]  49.450  62.900  54.960  74.900  71.360  67.800
[79]  85.140  21.300  72.200  78.410  82.300  51.510
[85]  74.660  45.200  65.300  87.220 100.000  95.720
[91] 100.000  72.590  44.460  70.000  59.350
> 
> #(d)
> ifelse(Class_mean>= 55 & Class_mean< 60, all_mean,0)
 [1]  0.000  0.000  0.000  0.000  0.000  0.000  0.000
 [8]  0.000  0.000  0.000  0.000  0.000  0.000  0.000
[15]  0.000  0.000  0.000  0.000  0.000  0.000  0.000
[22]  0.000  0.000  0.000  0.000  0.000  0.000  0.000
[29]  0.000  0.000  0.000  0.000  0.000  0.000  0.000
[36]  0.000  0.000 55.245  0.000  0.000  0.000  0.000
[43]  0.000  0.000 55.375  0.000  0.000  0.000  0.000
[50]  0.000  0.000  0.000  0.000  0.000  0.000  0.000
[57]  0.000  0.000  0.000  0.000  0.000  0.000  0.000
[64]  0.000  0.000  0.000  0.000 58.300  0.000 55.000
[71]  0.000  0.000  0.000  0.000  0.000  0.000  0.000
[78]  0.000  0.000  0.000  0.000  0.000  0.000  0.000
[85]  0.000  0.000  0.000  0.000  0.000  0.000  0.000
[92]  0.000  0.000  0.000 59.350
> install.packages("readxl")
WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:

https://cran.rstudio.com/bin/windows/Rtools/
Warning in install.packages :
  package ‘readxl’ is in use and will not be installed
> install.packages("readr")
WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:

https://cran.rstudio.com/bin/windows/Rtools/
Warning in install.packages :
  package ‘readr’ is in use and will not be installed
> 
